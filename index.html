<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Front</title>
  <link rel="stylesheet" href="golf.com">
  <style>
    @font-face {
      font-family: 'PixelFont';
      src: url('pixel-font.ttf') format('truetype'); 
    }
    body {
      background-image: url('https://preview.redd.it/for-hire-i-make-pixel-art-backgrounds-twitch-overlays-and-v0-mnslf2y8hxab1.gif?width=1920&auto=webp&s=1a04a51f2f19a3ed0438df7225d41428170de17d');
      background-size: cover;
      background-position: center;
      margin: 0;
      text-align: center;
      color: white;
      font-family: 'PixelFont', sans-serif;
      height: 100vh;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100vw;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      width: 100vw;
    }
    .title {
      font-size: 4rem;
      text-shadow: 4px 4px 0px black;
      color: yellow;
      transition: all 0.5s ease;
    }
    .title.top-left {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 2rem;
      text-align: left;
    }
    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .game-button {
      font-size: 2rem;
      padding: 10px 20px;
      margin: 10px;
      background: yellow;
      border: 4px solid black;
      cursor: pointer;
    }
    .game-button:hover {
      background: orange;
    }
    .hidden {
      display: none;
    }
    .loading-text {
      font-size: 2rem;
      color: yellow;
    }
    .top-right-buttons {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      flex-direction: column;
    }
    .small-button {
      font-size: 1rem;
      padding: 5px 10px;
      margin: 5px;
      background: yellow;
      border: 2px solid black;
      cursor: pointer;
    }
    .small-button:hover {
      background: orange;
    }
    .question-container {
      margin-top: 20px;
      text-align: center;
      font-size: 4rem;
    }
    .choices-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
      width: 90%;
    }
    .choice-button {
      font-size: 3rem;
      padding: 30px;
      background: yellow;
      border: 2px solid black;
      cursor: pointer;
      width: 100%;
    }
    .choice-button:hover {
      background: orange;
    }
    .big-box {
      width: 50%;
      padding: 20px;
      background: rgba(0, 0, 0, 0.7);
      border: 4px solid yellow;
      margin-top: 20px;
      color: yellow;
    }
    .question-box {
      width: 95%;
      padding: 30px;
      background: rgba(0, 0, 0, 0.7);
      border: 4px solid yellow;
      margin-top: 20px;
      text-align: center;
    }
    .back-button {
      position: absolute;
      bottom: 10px;
      left: 10px;
      font-size: 1.5rem;
      padding: 10px 20px;
      background: yellow;
      border: 2px solid black;
      cursor: pointer;
    }
    .back-button:hover {
      background: orange;
    }
    .split-screen {
      display: flex;
      width: 100%;
      height: 100vh;
    }
    .question-side {
      width: 50%;
      padding: 20px;
      background: rgba(0, 0, 0, 0.7);
      border-right: 4px solid yellow;
      overflow-y: auto;
    }
    .game-side {
      width: 50%;
      height: 100vh;
    }
    .game-frame {
      width: 100%;
      height: 100%;
      border: none;
    }
    .restore-button {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1rem;
      padding: 5px 10px;
      background: yellow;
      border: 2px solid black;
      cursor: pointer;
      z-index: 1000;
    }
    .restore-button:hover {
      background: orange;
    }
    .game-loading {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      font-size: 24px;
      color: yellow;
      z-index: 1000;
    }
    .back-button {
        position: fixed;
        bottom: 20px;
        left: 20px;
        padding: 10px 20px;
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        display: none; /* Hide the back button initially */
    }
    .back-button:hover {
        background: #45a049;
    }
    .medium-button {
      font-size: 1.25rem;
      padding: 7px 14px;
      margin: 5px;
      background: yellow;
      border: 2px solid black;
      cursor: pointer;
    }
    .medium-button:hover {
      background: orange;
    }
    .centered-button {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
    }
    .settings-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 80%; /* Increased width */
    }
    .medium-wide-button {
      font-size: 1.5rem; /* Increased font size */
      padding: 15px 30px; /* Increased padding */
      margin: 5px;
      background: yellow;
      border: 2px solid black;
      cursor: pointer;
      width: 250px; /* Increased width */
    }
    .medium-wide-button:hover {
      background: orange;
    }
    .scroll-button {
      display: none; /* Hide the scroll button */
    }
    .instructions-container {
      width: 30vw; /* Make it narrower */
      max-height: 40vh; /* Keep it smaller */
      display: none; /* Hide the instructions container initially */
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.8);
      color: yellow; /* Make the text yellow */
      padding: 20px;
      border: 4px solid yellow;
      border-radius: 10px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="title" id="game-title">PhysiXperience</h1>
    <div id="menu" class="button-container">
      <button class="game-button" onclick="startGame()">Start Game</button>
      <div style="display: flex; flex-direction: row;">
        <button class="game-button" onclick="openSettings()">Settings</button>
        <button class="game-button" onclick="showInstructions()">Instructions</button>
      </div>
    </div>
    <div id="loading" class="hidden">
      <p class="loading-text">Game is Loading...</p>
    </div>
    <div id="game-buttons" class="hidden button-container">
      <button class="medium-button" style="position: absolute; bottom: 10px; right: 10px;" onclick="goBackToMenu()">Back</button>
    </div>
    <div id="extra-buttons" class="hidden button-container">
      <button class="medium-button" style="position: absolute; bottom: 10px; right: 10px;" onclick="goBackToGameButtons()">Back</button>
    </div>
    <div id="top-right-buttons" class="hidden top-right-buttons"></div>
    <div id="game-links-buttons" class="hidden button-container"></div>
    <button id="back-button" class="hidden back-button" onclick="goBack()">Back</button>
    <div id="instructions-container" class="hidden big-box" style="overflow-y: auto;">
      <h1>Instructions</h1>
      <h2>Golf Physics</h2>
      <p>1. Control the values for the game such as (velocity, angle and distance to the hole)</p>
      <p>2. The values can be seen on the upper right which it is calculated during the simulation</p>
      <p>3. After placing the values press the >hit the ball< button to create the simulation </p>
      <p>4. The results will pop up and reset button to recreate another simulation</p>
      <h2>Tow Truck Xperience</h2>
      <p>1. Control the values using the range for the game having the masses, speed, and duration/time to travel</p>
      <p>2. Press the remove car to remove the car loaded on the truck and add car load to place it Back</p>
      <p>3. The values can be seen on the upper right which it is calculated during the simulation</p>
      <p>4. Press the >Start Towing< to proceed the simulation </p>
      <p>5. The results will pop up and reset button to recreate another simulation</p>
      <h2>PhysiTest</h2>
      <p>1. Choose the difficulty of the test (Easy, Normal, Hard)</p>
      <p>2. Clicking the small button on the right top will be used to open simulation to help answering the Test</p>
      <p>2. Answer the questions by clicking the choices</p>
      <p>3. The score will be reveal after finishing the test</p>
      <p>4. The answer will from the test will not be shown for players to re-answer the game without the script of answers</p>
      <p>4. The test can be retaken after answering the other difficulty</p>
      <button class="small-button" style="position: absolute; bottom: 10px; right: 10px;" onclick="closeInstructions()">Back</button>
    </div>
  </div>
  <div id="game-loading" class="game-loading">
    <p>Loading Game...</p>
  </div>
  <button class="back-button" onclick="startGame">Back</button>

  <audio id="click-sound" src="c:\Users\Acer\Downloads\capstone\Music 1.mp3"></audio>
  <audio id="correct-sound" src="Quiz Game/TING SOUND EFFECT [ ezmp3.cc ].mp3"></audio>
  <audio id="incorrect-sound" src="Quiz Game/Wrong Answer - Sound Effect HD [ ezmp3.cc ].mp3"></audio>
  

  <script>
    
    let currentScreen = 'menu';
    let lastQuestionIndex = 0;
    const screenHistory = [];
    let currentQuestionIndex = 0;
    let currentQuestions = [];
    let score = 0;
    let soundOn = true;
    let musicOn = true;
    let backgroundMusic;
    let pointsPerQuestion = 1; // Default points per question

    const easyQuestions = [
      {
        question: "A golf ball is in the field, located 0.34 km (340 m) from the hole. If the ball is hit at an angle of 45°, what should its velocity be to reach the hole?",
        choices: ["63m/s", "64m/s", "66m/s", "67m/s"],
        correct: "66m/s"
      },
      {
        question: "A golfer hits a ball toward the hole at a constant velocity of 30 m/s having an angle of 80 degree If the hole is 30 meters away, how long will it take for the ball to reach the hole?",
        choices: ["5s", "5.4s", "5.9s", "4.9s"],
        correct: "5.9s"
      },
      {
        question: "A tow truck with a mass of 800kg that pulls a broken car 300kg. Having a speed of  28m/s over a time period  of 10 seconds . How much work will be done by the towtruck?",
        choices: [" 60,924.60", "59,429.60", "62,429.60", "60,429.60"],
        correct: "60,429.60"
      },
      {
        question: "For a projectile launched at the same angle, how does the initial velocity affect the distance it travels?",
        choices: [" The higher the velocity, the shorter the distance it travels.", "The lower the velocity, the longer the distance it travels.", "The higher the velocity, the longer the distance it travels.", "The initial velocity has no effect on the distance traveled."],
        correct: "The higher the velocity, the longer the distance it travels."
      },
      {
        question: "If you double the time it takes to do a certain amount of work, what happens to the power?",
        choices: ["It doubles.", "It is halved.", "It quadruples.", "It is quartered."],
        correct: "It is halved."
      },
    ];

    const normalQuestions = [
      {
        question: "The towtruck lifts a 400kg car with a 40m/s speed traveling for 15s . How much is the mass of the Tow truck to have a power of 14.911Kw (Kilowatt)?",
        choices: ["1500kg", "1200kg", "1000kg", "1800kg"],
        correct: "1500kg"
      },
      {
        question: "A golfer hits a golf ball with an initial velocity of 30 m/s from  70m at an angle of 55° to the horizontal. Assume acceleration due to gravity is 9.8 m/s². What is the total Air time of the ball?",
        choices: ["4.5s", "4.7s", "4.8s", "5s"],
        correct: "4.8s"
      },
      {
        question: "A tow truck pulls a car at a constant speed of 15 m/s on a level road. If the power output of the truck will be 6000 W,  what is the work done of the object in 5 seconds having the combined mass of 2039kg?",
        choices: ["31,034J", "30,052J", "30,034J", "31,052J"],
        correct: "30,052"
      },
    ];

    const hardQuestions = [
      {
        question: "Golfer A's ball moves at 40m/s, while Golfer B's ball moves at 55 m/s. If both balls travel at a 30° angle from 1km (1000m), what is the difference of the distance does Golfer B's ball travel than Golfer A's ?",
        choices: ["99.4m", "100m", "97.7m", "98.6m"],
        correct: "99.4m"
      },
      {
        question: " The Tow truck A. travels 30m/s at 10sec while the Tow truck B travels at the same rate but pulls a car with a 250kg. What is the difference in power used having a mass of the towtruck 1000kg?",
        choices: ["1571.5 W", "1471.5 W", "1417.5 W", "1451.7 W"],
        correct: "1471.5 W"
      },
    ];

    function startBackgroundMusic() {
      if (!backgroundMusic) {
        backgroundMusic = new Audio('Music 1.mp3');
        backgroundMusic.loop = true;
      }
      if (musicOn) {
        backgroundMusic.play();
      }
    }

    function startGame() {
      screenHistory.push(currentScreen);
      currentScreen = 'loading';
      document.getElementById('menu').classList.add('hidden');
      document.getElementById('loading').classList.remove('hidden');
      document.getElementById('back-button').classList.remove('hidden');
      
      startBackgroundMusic(); // Start playing background music

      setTimeout(() => {
        document.getElementById('loading').classList.add('hidden');
        const gameButtonsContainer = document.getElementById('game-buttons');
        gameButtonsContainer.classList.remove('hidden');
        currentScreen = 'game-buttons';
        
        const buttonNames = getButtonNames();
        
        gameButtonsContainer.innerHTML = ''; // Clear existing buttons
        for (let i = 0; i < buttonNames.length; i++) {
          const button = document.createElement('button');
          button.className = 'game-button';
          button.textContent = buttonNames[i];
          gameButtonsContainer.appendChild(button);
          
          if (buttonNames[i] === 'PhysiTest') {
            button.addEventListener('click', () => {
              loadPhysiTest();
            });
          } else if (buttonNames[i] === 'Golf Physics') {
            button.addEventListener('click', () => {
              loadGameLink('https://kaishin-prog.github.io/Golf-Physics/');
            });
          } else if (buttonNames[i] === 'Tow Truck Xperience') {
            button.addEventListener('click', () => {
              loadGameLink('https://kaishin-prog.github.io/Tow-Truck-X/');
            });
          }
        }

        // Add a back button to the game buttons screen
        const backButton = document.createElement('button');
        backButton.className = 'medium-button';
        backButton.textContent = 'Back';
        backButton.style.position = 'absolute';
        backButton.style.bottom = '10px';
        backButton.style.right = '10px';
        backButton.addEventListener('click', () => {
          goBackToMenu();
        });
        gameButtonsContainer.appendChild(backButton);

        // Apply button sound to newly created buttons
        applyButtonSound();

      }, 2000); // Simulate loading time
    }

    function goBackToMenu() {
      document.getElementById('game-buttons').classList.add('hidden');
      document.getElementById('menu').classList.remove('hidden');
      currentScreen = 'menu';
    }

    function getButtonNames() {
      // You can modify this array to set custom names for the buttons
      return ['Golf Physics', 'Tow Truck Xperience', 'PhysiTest'];
    }
    
    function loadPhysiTest() {
        screenHistory.push(currentScreen);
        currentScreen = 'game-loading';
        document.getElementById('game-title').classList.add('top-left');
        document.getElementById('game-buttons').classList.add('hidden');
        document.getElementById('game-loading').style.display = 'block';
        document.getElementById('back-button').classList.add('hidden'); // Hide the back button
        
        setTimeout(() => {
          document.getElementById('game-loading').style.display = 'none';
            const extraButtonsContainer = document.getElementById('extra-buttons');
            extraButtonsContainer.classList.remove('hidden');
            currentScreen = 'extra-buttons';
            
            const extraButtonNames = ['Easy', 'Normal', 'Hard'];
            
            extraButtonsContainer.innerHTML = ''; // Clear existing buttons
            for (let i = 0; i < extraButtonNames.length; i++) {
                const button = document.createElement('button');
                button.className = 'game-button';
                button.textContent = extraButtonNames[i];
                extraButtonsContainer.appendChild(button);
                button.addEventListener('click', () => {
                    if (extraButtonNames[i] === 'Easy' || extraButtonNames[i] === 'Normal' || extraButtonNames[i] === 'Hard') {
                        document.getElementById('back-button').classList.add('hidden');
                    }
                    if (extraButtonNames[i] === 'Easy') {
                        currentQuestions = easyQuestions;
                    } else if (extraButtonNames[i] === 'Normal') {
                        currentQuestions = normalQuestions;
                    } else if (extraButtonNames[i] === 'Hard') {
                        currentQuestions = hardQuestions;
                    }
                    score = 0; // Reset score
                    showQuestion(0);
                });
            }

            // Add a back button to the difficulty selection screen
            const backButton = document.createElement('button');
            backButton.className = 'medium-button';
            backButton.textContent = 'Back';
            backButton.style.position = 'absolute';
            backButton.style.bottom = '10px';
            backButton.style.right = '10px';
            backButton.addEventListener('click', () => {
                goBackToGameButtons();
                document.getElementById('game-title').classList.remove('top-left');
            });
            extraButtonsContainer.appendChild(backButton);

            // Move the title to the top left corner
            document.getElementById('game-title').classList.add('top-left');

            // Change the background
            document.body.style.backgroundImage = "url('https://cdn1.epicgames.com/ue/product/Screenshot/Screenshot07-1920x1080-0cb979cb04beb1d815c092e491a51ff1.jpg?resize=1&w=1920')";

            // Apply button sound to newly created buttons
            applyButtonSound();
        }, 2000); // Simulate loading time
    }
    
    function loadGameLink(gameLink) {
      screenHistory.push(currentScreen);
      currentScreen = 'game-link';
      document.getElementById('game-buttons').classList.add('hidden');
      const gameLinksButtonsContainer = document.getElementById('game-links-buttons');
      gameLinksButtonsContainer.classList.remove('hidden');
      gameLinksButtonsContainer.innerHTML = `
        <iframe src="${gameLink}" class="game-frame" style="width: 100vw; height: 100vh; border: none; position: absolute; top: 0; left: 0;"></iframe>
        <button class="small-button" onclick="goBackToGameScreen()" style="position: absolute; bottom: 10px; right: 10px;">Return</button>
      `;
    }

    function goBackToGameScreen() {
        document.getElementById('game-links-buttons').classList.add('hidden');
        document.getElementById('game-buttons').classList.remove('hidden');
        currentScreen = 'game-buttons';
    }

    function goToQuestionSection() {
      screenHistory.push(currentScreen);
      currentScreen = 'question';
      document.getElementById('game-links-buttons').classList.add('hidden');
      document.getElementById('extra-buttons').classList.remove('hidden');
      showQuestion(currentQuestionIndex);
    }

    function showQuestion(index) {
      if (index >= currentQuestions.length) {
        finishTest();
        return;
      }
      currentQuestionIndex = index;
      lastQuestionIndex = index; // Store the current question index
      screenHistory.push(currentScreen);
      currentScreen = 'question';
      const extraButtonsContainer = document.getElementById('extra-buttons');
      const question = currentQuestions[index];
      extraButtonsContainer.innerHTML = `
        <div class="question-box">
          <div class="question-container">
            <p>${question.question}</p>
          </div>
        </div>
        <div class="choices-container">
          ${question.choices.map(choice => `<button class="choice-button" onclick="nextQuestion('${choice}')">${choice}</button>`).join('')}
        </div>
      `;
      document.getElementById('back-button').classList.add('hidden'); // Hide the back button

      // Add small buttons to the top right corner
      const topRightButtonsContainer = document.getElementById('top-right-buttons');
      topRightButtonsContainer.classList.remove('hidden');
      
      const smallButtonNames = ['Golf Physics', 'Tow Truck Xperience'];
      const smallButtonLinks = ['https://kaishin-prog.github.io/Golf-Physics/', 'https://kaishin-prog.github.io/Tow-Truck-X/'];
      
      topRightButtonsContainer.innerHTML = ''; // Clear existing buttons
      for (let i = 0; i < smallButtonNames.length; i++) {
        const button = document.createElement('button');
        button.className = 'small-button';
        button.textContent = smallButtonNames[i];
        topRightButtonsContainer.appendChild(button);
        button.addEventListener('click', () => {
          handleSmallButtonClick(smallButtonLinks[i]);
        });
      }
    }

    function nextQuestion(selectedChoice) {
      const currentQuestion = currentQuestions[currentQuestionIndex];
      if (selectedChoice === currentQuestion.correct) {
        score += pointsPerQuestion;
        playSound('correct-sound');
      } else {
        playSound('incorrect-sound');
      }
      showQuestion(currentQuestionIndex + 1);
    }

    function calculateFinalScore() {
      if (currentQuestions === normalQuestions) {
        return score * 1;
      } else if (currentQuestions === hardQuestions) {
        return score * 1;
      }
      return score;
    }

    function finishTest() {
        screenHistory.push(currentScreen);
        currentScreen = 'finish';
        document.getElementById('extra-buttons').classList.add('hidden');
        document.getElementById('game-loading').style.display = 'block';

        // Show game loading screen for 2 seconds before showing the result
        setTimeout(() => {
            document.getElementById('game-loading').style.display = 'none';
            const finalScore = calculateFinalScore();
            const extraButtonsContainer = document.getElementById('extra-buttons');
            extraButtonsContainer.innerHTML = `
                <div class="question-box">
                    <div class="question-container">
                        <p>Test finished! Your score is ${finalScore} out of ${currentQuestions.length * pointsPerQuestion}.</p>
                    </div>
                </div>
                ${currentQuestions === easyQuestions ? `
                <div style="display: flex; justify-content: center;">
                    <button class="game-button" onclick="loadNormalQuestions()">Normal</button>
                    <button class="game-button" onclick="loadHardQuestions()">Hard</button>
                </div>
                ` : currentQuestions === normalQuestions ? `
                <div style="display: flex; justify-content: center;">
                    <button class="game-button" onclick="loadEasyQuestions()">Easy</button>
                    <button class="game-button" onclick="loadHardQuestions()">Hard</button>
                </div>
                ` : currentQuestions === hardQuestions ? `
                <div style="display: flex; justify-content: center;">
                    <button class="game-button" onclick="loadEasyQuestions()">Easy</button>
                    <button class="game-button" onclick="loadNormalQuestions()">Normal</button>
                </div>
                ` : ''}
                <button class="game-button" style="position: absolute; bottom: 10px; right: 10px;" onclick="goBackToStartWithLoadingAndHideButtons()">Back</button>
            `;
            extraButtonsContainer.classList.remove('hidden');
            document.getElementById('back-button').classList.add('hidden'); // Hide the back button

            // Reset the screen
            screenHistory.length = 0;
            currentScreen = 'menu';

            // Apply button sound to newly created buttons
            applyButtonSound();
        }, 2000); // Simulate loading time
    }

    function goBackToSecondPage() {
        // Logic to go back to the second page
        screenHistory.push(currentScreen);
        currentScreen = 'game-buttons';
        document.getElementById('extra-buttons').classList.add('hidden');
        document.getElementById('game-buttons').classList.remove('hidden');
    }

    function loadNormalQuestions() {
        currentQuestions = normalQuestions;
        pointsPerQuestion = 2; // Set points per question for normal questions
        score = 0; // Reset score
        showQuestion(0);
    }

    function loadHardQuestions() {
        currentQuestions = hardQuestions;
        pointsPerQuestion = 3; // Set points per question for hard questions
        score = 0; // Reset score
        showQuestion(0);
    }

    function returnToDifficultySelection() {
        screenHistory.push(currentScreen);
        currentScreen = 'extra-buttons';
        document.getElementById('extra-buttons').classList.add('hidden');
        document.getElementById('game-loading').style.display = 'block';
        setTimeout(() => {
            document.getElementById('game-loading').style.display = 'none';
            document.getElementById('extra-buttons').classList.remove('hidden');
            document.getElementById('back-button').classList.add('hidden'); // Keep the back button hidden
            loadPhysiTest();
            duplicateDifficultySelection(); // Call the function to duplicate difficulty selection
        }, 2000); // Simulate loading time
    }

    function goBackToDifficulty() {
        screenHistory.push(currentScreen);
        currentScreen = 'extra-buttons';
        document.getElementById('extra-buttons').classList.add('hidden');
        document.getElementById('game-loading').style.display = 'block';
        setTimeout(() => {
            document.getElementById('game-loading').style.display = 'none';
            document.getElementById('extra-buttons').classList.remove('hidden');
            document.getElementById('back-button').classList.add('hidden'); // Keep the back button hidden
            loadPhysiTest();
            duplicateDifficultySelection(); // Call the function to duplicate difficulty selection
        }, 2000); // Simulate loading time
    }

    function duplicateDifficultySelection() {
        const extraButtonsContainer = document.getElementById('extra-buttons');
        const extraButtonNames = ['Easy', 'Normal', 'Hard'];
        
        extraButtonsContainer.innerHTML = ''; // Clear existing buttons
        for (let i = 0; i < extraButtonNames.length; i++) {
            const button = document.createElement('button');
            button.className = 'game-button';
            button.textContent = extraButtonNames[i];
            extraButtonsContainer.appendChild(button);
            button.addEventListener('click', () => {
                if (extraButtonNames[i] === 'Easy' || extraButtonNames[i] === 'Normal' || extraButtonNames[i] === 'Hard') {
                    document.getElementById('back-button').classList.add('hidden');
                }
                if (extraButtonNames[i] === 'Easy') {
                    currentQuestions = easyQuestions;
                } else if (extraButtonNames[i] === 'Normal') {
                    currentQuestions = normalQuestions;
                } else if (extraButtonNames[i] === 'Hard') {
                    currentQuestions = hardQuestions;
                }
                score = 0; // Reset score
                showQuestion(0);
            });
        }

        // Add a back button to the difficulty selection screen
        const backButton = document.createElement('button');
        backButton.className = 'medium-button';
        backButton.textContent = 'Back';
        backButton.addEventListener('click', () => {
            goBackToGameButtons();
            document.getElementById('game-title').classList.remove('top-left');
        });
        extraButtonsContainer.appendChild(backButton);

        // Move the title to the top left corner
        document.getElementById('game-title').classList.add('top-left');

        // Apply button sound to newly created buttons
        applyButtonSound();
    }

    function showGameLoadingAndGoBackToDifficulty() {
        document.getElementById('extra-buttons').classList.add('hidden');
        document.getElementById('game-loading').style.display = 'block';
        setTimeout(() => {
            document.getElementById('game-loading').style.display = 'none';
            goBackToDifficulty();
            debugButtons(); // Call the debug function
        }, 2000); // Simulate loading time
    }

    function goBackToDifficulty() {
        screenHistory.push(currentScreen);
        currentScreen = 'extra-buttons';
        document.getElementById('extra-buttons').classList.add('hidden');
        document.getElementById('loading').classList.remove('hidden');
        document.getElementById('game-title').classList.add('top-left'); // Keep the back button hidden
        setTimeout(() => {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('extra-buttons').classList.remove('hidden');
            document.getElementById('back-button').classList.add('hidden'); // Keep the back button hidden
            loadPhysiTest();
            debugButtons(); // Call the debug function
        }, 2000); // Simulate loading time
    }

    function debugButtons() {
        const buttons = document.querySelectorAll('.game-button, .small-button, .choice-button');
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                console.log(`Button clicked: ${button.textContent}`);
            });
        });
    }

    function showGameLoadingAndGoBackToPhysTest() {
      document.getElementById('extra-buttons').classList.add('hidden');
      document.getElementById('game-loading').style.display = 'block';
      
      setTimeout(() => {
          document.getElementById('game-loading').style.display = 'none';
          goBackToPhysTest();
      }, 2000); // Simulate loading time
    }

    function showGameLoading() {
      document.getElementById('extra-buttons').classList.add('hidden');
      document.getElementById('game-loading').style.display = 'block';
      setTimeout(() => {
        document.getElementById('game-loading').style.display = 'none';
        goBackToDifficulty();
      }, 2000); // Simulate loading time
    }

    function showLoadingAndGoBackToDifficulty() {
      document.getElementById('extra-buttons').classList.add('hidden');
      document.getElementById('loading').classList.remove('hidden');
      setTimeout(() => {
        goBackToDifficulty();
      }, 2000); // Simulate loading time
    }

    function goBackToDifficulty() {
      screenHistory.push(currentScreen);
      currentScreen = 'extra-buttons';
      document.getElementById('extra-buttons').classList.add('hidden');
      document.getElementById('loading').classList.remove('hidden');
      setTimeout(() => {
        document.getElementById('loading').classList.add('hidden');
        document.getElementById('extra-buttons').classList.remove('hidden');
        document.getElementById('back-button').classList.add('hidden'); // Keep the back button hidden
        loadPhysiTest();
        debugButtons(); // Call the debug function
      }, 2000); // Simulate loading time
    }

    function debugButtons() {
      const buttons = document.querySelectorAll('.game-button, .small-button, .choice-button');
      buttons.forEach(button => {
        button.addEventListener('click', () => {
          console.log(`Button clicked: ${button.textContent}`);
        });
      });
    }

    function goBackToGameButtons() {
      screenHistory.push(currentScreen);
      currentScreen = 'game-buttons';
      document.getElementById('extra-buttons').classList.add('hidden');
      document.getElementById('game-links-buttons').classList.add('hidden');
      document.getElementById('game-buttons').classList.remove('hidden');
      document.getElementById('game-title').classList.remove('top-left'); // Remove the top-left class
      resetBackground();
    }

    function goBackToCurrentQuestions() {
      screenHistory.push(currentScreen);
      currentScreen = 'question';
      document.getElementById('game-links-buttons').classList.add('hidden');
      document.getElementById('extra-buttons').classList.remove('hidden');
      showQuestion(currentQuestionIndex);
    }

    function goBack() {
      if (screenHistory.length > 0) {
        const previousScreen = screenHistory.pop();
        switch (currentScreen) {
          case 'loading':
            document.getElementById('loading').classList.add('hidden');
            break;
          case 'game-buttons':
            document.getElementById('game-buttons').classList.add('hidden');
            break;
          case 'extra-buttons':
            document.getElementById('extra-buttons').classList.add('hidden');
            break;
          case 'settings':
            document.getElementById('extra-buttons').classList.add('hidden');
            break;
          case 'question':
            document.getElementById('extra-buttons').innerHTML = '';
            document.getElementById('extra-buttons').classList.remove('hidden');
            break;
          case 'finish':
            document.getElementById('extra-buttons').innerHTML = '';
            break;
          case 'game-link':
            document.getElementById('game-links-buttons').classList.add('hidden');
          case 'finishedtest':
            document.getElementById('finishedtest').classList.add('hidden');
            break;
        }
        currentScreen = previousScreen;
        switch (currentScreen) {
          case 'menu':
            document.getElementById('menu').classList.remove('hidden');
            document.getElementById('back-button').classList.add('hidden');
            break;
          case 'loading':
            document.getElementById('loading').classList.remove('hidden');
            break;
          case 'game-buttons':
            document.getElementById('game-buttons').classList.remove('hidden');
            break;
          case 'extra-buttons':
            document.getElementById('extra-buttons').classList.remove('hidden');
            break;
          case 'question':
            showQuestion(currentQuestionIndex);
            break;
          case 'finish':
            goBackToDifficulty(); // Go back to difficulty selection after finishing the test
            break;
          case 'game-link':
            goBackToCurrentQuestions(); // Go back to game question if returning from a game link
            break;
        }
      }
    }

    function resetBackground() {
      document.body.style.backgroundImage = "url('https://preview.redd.it/for-hire-i-make-pixel-art-backgrounds-twitch-overlays-and-v0-mnslf2y8hxab1.gif?width=1920&auto=webp&s=1a04a51f2f19a3ed0438df7225d41428170de17d')";
    }

    function openSettings() {
      screenHistory.push(currentScreen);
      currentScreen = 'settings';
      document.getElementById('menu').classList.add('hidden');
      const extraButtonsContainer = document.getElementById('extra-buttons');
      extraButtonsContainer.classList.remove('hidden');
      extraButtonsContainer.innerHTML = `
        <div class="question-box">
          <div class="question-container">
            <p>Settings</p>
          </div>
        </div>
        <div class="settings-container">
          <button id="music-button" class="medium-wide-button" onclick="toggleMusic()">Toggle Music</button>
          <button class="game-button" onclick="goBack()">Back</button>
        </div>
      `;
      document.getElementById('back-button').classList.remove('hidden');

      // Apply button sound to newly created buttons
      applyButtonSound();
    }

    function toggleMusic() {
      musicOn = !musicOn;
      updateButtonColor('music-button', musicOn);
      toggleBackgroundMusic();
      const clickSound = document.getElementById('click-sound');
      if (musicOn) {
        clickSound.play();
      } else {
        clickSound.pause();
      }
    }

    function updateButtonColor(buttonId, isOn) {
      const button = document.getElementById(buttonId);
      if (isOn) {
        button.style.backgroundColor = 'yellow';
      } else {
        button.style.backgroundColor = 'red';
      }
    }

    function toggleBackgroundMusic() {
      if (!backgroundMusic) {
        backgroundMusic = new Audio('Music 1.mp3');
        backgroundMusic.loop = true;
      }
      if (musicOn) {
        backgroundMusic.play();
      } else {
        backgroundMusic.pause();
      }
    }

    let isGameLinkOpen = false;

    function handleSmallButtonClick(gameLink) {
      if (isGameLinkOpen) {
        closeGameLink();
      } else {
        openFullScreenGame(gameLink);
      }
      isGameLinkOpen = !isGameLinkOpen;
    }

    function openFullScreenGame(gameLink) {
      const container = document.querySelector('.container');
      container.innerHTML = `
        <iframe src="${gameLink}" class="game-frame" style="width: 100vw; height: 100vh; border: none;"></iframe>
        <button class="restore-button" onclick="closeGameLink()">Close Game</button>
      `;
    }

    function closeGameLink() {
      restoreOriginalLayout();
      isGameLinkOpen = false;
    }

    function restoreOriginalLayout() {
      // Restore original layout
      const container = document.querySelector('.container');
      container.innerHTML = `
        <h1 class="title top-left" id="game-title">PhysXperience</h1>
        <div id="extra-buttons" class="button-container"></div>
        <div id="top-right-buttons" class="top-right-buttons"></div>
        <button id="back-button" class="back-button" onclick="goBack()">Back</button>
      `;

      // Return to the current question, finish screen, or difficulty selection
      if (currentScreen === 'question') {
        showQuestion(currentQuestionIndex);
      } else if (currentScreen === 'finish') {
        finishTest();
      } else if (currentScreen === 'extra-buttons') {
        loadPhysiTest();
      } else if (currentScreen === 'game-buttons') {
        document.getElementById('game-buttons').classList.remove('hidden');
      }

      // Refresh the buttons
      const topRightButtonsContainer = document.getElementById('top-right-buttons');
      topRightButtonsContainer.classList.remove('hidden');
      
      const smallButtonNames = ['Golf Physics', 'Tow Truck Xperience', 'PhysiTest'];
      const smallButtonLinks = ['https://kaishin-prog.github.io/Golf-Physics/', 'https://kaishin-prog.github.io/Tow-Truck-X/', 'javascript:loadPhysiTest()'];
      topRightButtonsContainer.innerHTML = '';
      for (let i = 0; i < smallButtonNames.length; i++) {
        const button = document.createElement('button');
        button.className = 'small-button';
        button.textContent = smallButtonNames[i];
        topRightButtonsContainer.appendChild(button);
        button.addEventListener('click', () => {
          handleSmallButtonClick(smallButtonLinks[i]);
        });
      }
    }

    function toggleBackgroundMusic() {
      if (!backgroundMusic) {
        backgroundMusic = new Audio('Music 1.mp3');
        backgroundMusic.loop = true;
      }
      if (musicOn) {
        backgroundMusic.play();
      } else {
        backgroundMusic.pause();
      }
    }

    function goBackToPreviousScreen() {
      if (screenHistory.length > 0) {
        const previousScreen = screenHistory.pop();
        switch (previousScreen) {
          case 'menu':
            document.getElementById('menu').classList.remove('hidden');
            break;
          case 'loading':
            document.getElementById('loading').classList.remove('hidden');
            break;
          case 'game-buttons':
            document.getElementById('game-buttons').classList.remove('hidden');
            break;
          case 'extra-buttons':
            document.getElementById('extra-buttons').classList.remove('hidden');
            break;
          case 'question':
            showQuestion(currentQuestionIndex);
            break;
          case 'finish':
            finishTest();
            break;
          case 'game-link':
            document.getElementById('game-links-buttons').classList.remove('hidden');
            break;
        }
        currentScreen = previousScreen;
      }
    }

    function goBackToStart() {
        window.location.href = 'Quiz.html'; // Adjust the path if necessary
    }

    function goBackToStartWithLoading() {
        document.getElementById('game-loading').style.display = 'block';
        setTimeout(() => {
            window.location.href = 'Quiz.html'; // Adjust the path if necessary
        }, 2000); // Simulate loading time
    }

    function loadEasyQuestions() {
        currentQuestions = easyQuestions;
        pointsPerQuestion = 1; // Reset points per question for easy questions
        score = 0; // Reset score
        showQuestion(0);
    }

    function goBackToStartWithLoadingAndHideButtons() {
        document.getElementById('game-loading').style.display = 'block';
        document.querySelectorAll('.game-button').forEach(button => button.style.display = 'none');
        setTimeout(() => {
            window.location.href = 'Quiz.html'; // Adjust the path if necessary
        }, 2000); // Simulate loading time
    }

    function playSound(soundId) {
      const sound = document.getElementById(soundId);
      if (sound) {
        sound.play();
      }
    }

    // Example of playing click sound on button click
    document.querySelectorAll('.game-button, .choice-button').forEach(button => {
      button.addEventListener('click', () => {
        playSound('click-sound');
      });
    });

    function applyButtonSound() {
      const buttons = document.querySelectorAll('button:not(.choice-button)');
      const buttonSound = document.getElementById('button-sound');
      buttons.forEach(button => {
        button.addEventListener('click', () => {
          buttonSound.play();
        });
      });
    }

    // Call the function to apply button sound initially
    applyButtonSound();

    function toggleBackgroundMusic() {
      if (!backgroundMusic) {
        backgroundMusic = new Audio('Music 1.mp3');
        backgroundMusic.loop = true;
      }
      if (musicOn) {
        backgroundMusic.play();
      } else {
        backgroundMusic.pause();
      }
    }

    function toggleMusic() {
      musicOn = !musicOn;
      updateButtonColor('music-button', musicOn);
      toggleBackgroundMusic();
      const clickSound = document.getElementById('click-sound');
      if (musicOn) {
        clickSound.play();
      } else {
        clickSound.pause();
      }
    }

    function showInstructions() {
      document.getElementById('menu').classList.add('hidden');
      const instructionsContainer = document.getElementById('instructions-container');
      if (!instructionsContainer) {
        const newInstructionsContainer = document.createElement('div');
        newInstructionsContainer.id = 'instructions-container';
        newInstructionsContainer.className = 'instructions-container';
        newInstructionsContainer.innerHTML = `
          <h1>Instructions</h1>
          <h2>Golf Physics</h2>
          <p>1. Control the values for the game such as (velocity, angle and distance to the hole)</p>
          <p>2. The values can be seen on the upper right which it is calculated during the simulation</p>
          <p>3. After placing the values press the >hit the ball< button to create the simulation </p>
          <p>4. The results will pop up and reset button to recreate another simulation</p>
          <h2>Tow Truck Xperience</h2>
          <p>1. Control the values using the range for the game having the masses, speed, and duration/time to travel</p>
          <p>2. Press the remove car to remove the car loaded on the truck and add car load to place it Back</p>
          <p>3. The values can be seen on the upper right which it is calculated during the simulation</p>
          <p>4. Press the >Start Towing< to proceed the simulation </p>
          <p>5. The results will pop up and reset button to recreate another simulation</p>
          <h2>PhysiTest</h2>
          <p>1. Choose the difficulty of the test (Easy, Normal, Hard)</p>
          <p>2. Clicking the small button on the right top will be used to open simulation to help answering the Test</p>
          <p>2. Answer the questions by clicking the choices</p>
          <p>3. The score will be reveal after finishing the test</p>
          <p>4. The answer will from the test will not be shown for players to re-answer the game without the script of answers</p>
          <p>4. The test can be retaken after answering the other difficulty</p>
          <button class="small-button" style="position: absolute; bottom: 10px; right: 10px;" onclick="closeInstructions()">Back</button>
        `;
        document.body.appendChild(newInstructionsContainer);
      } else {
        instructionsContainer.classList.remove('hidden');
      }
      document.getElementById('game-title').classList.add('top-left');
      ensureInstructionsFit();
    }

    function closeInstructions() {
      const instructionsContainer = document.getElementById('instructions-container');
      if (instructionsContainer) {
        instructionsContainer.classList.add('hidden');
      }
      document.getElementById('menu').classList.remove('hidden');
      document.getElementById('game-title').classList.remove('top-left');
    }

    function ensureInstructionsFit() {
      const container = document.getElementById('instructions-container');
      const maxHeight = window.innerHeight * 0.4;
      container.style.maxHeight = `${maxHeight}px`;
    }
  </script>
</body>
</html>
